% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/bootstrap_helpers.R
\name{bootstrap_interval_levene}
\alias{bootstrap_interval_levene}
\title{Residual bootstrap under H0 for the interval-Levene F}
\usage{
bootstrap_interval_levene(
  df,
  omega = 1,
  R = 2000,
  seed = NULL,
  return_draws = FALSE
)
}
\arguments{
\item{df}{A list of per-group data.frames (first two columns are center/radius),
or a single data.frame with columns \code{center}, \code{radius}, \code{group} (factor-able).}

\item{omega}{Nonnegative weight on the radius term in \eqn{Y}. Default 1.}

\item{R}{Number of bootstrap replicates. Default 2000.}

\item{seed}{Optional integer seed for reproducibility.}

\item{return_draws}{If \code{TRUE}, include the vector of bootstrap draws \code{F_star}.}
}
\value{
A list with components:
\itemize{
\item \code{F_obs}: observed interval-Levene F statistic.
\item \code{crit_95}: 0.95 bootstrap critical value for \code{F}.
\item \code{p_value}: bootstrap p-value, \eqn{\mathrm{mean}(F^\ast \ge F_{\mathrm{obs}})}.
\item \code{R}: number of bootstrap replicates used.
\item \code{F_star} (present if \code{return_draws=TRUE}): vector of bootstrap draws.
}
}
\description{
Computes a Levene-type F on interval data where each observation is an
interval \eqn{[C \pm R]} via the proxy
\deqn{Y_{ij}=(C_{ij}-\bar C_i)^2 + \omega(R_{ij}-\bar R_i)^2,}
then calibrates the test using a \strong{residual bootstrap under the null}
(equal group variances) by rescaling group residuals to the pooled SD
and resampling within groups.
}
\details{
The bootstrap “imposes the null” of equal variances by (i) removing group means,
(ii) rescaling each group’s residuals to the pooled SD, (iii) adding back the
common mean, and (iv) resampling within groups to original sizes. This yields a
bootstrap null for the F statistic that respects group sizes and mean structure.
}
\examples{
\donttest{
## Example 1: Single data.frame input (3 groups, unequal variances)
set.seed(123)
n_per_group <- c(40, 45, 50)
g <- factor(rep(LETTERS[1:3], times = n_per_group))
muC <- c(A = 0,  B = 0.5, C = -0.5)[g]
muR <- c(A = 1,  B = 1,   C = 1)[g]
sdC <- c(A = 0.5, B = 0.8, C = 1.1)[g]
sdR <- c(A = 0.4, B = 0.4, C = 0.9)[g]
dat <- data.frame(
  center = rnorm(length(g), mean = muC, sd = sdC),
  radius = pmax(1e-6, rnorm(length(g), mean = muR, sd = sdR)),
  group  = g
)
fit1 <- bootstrap_interval_levene(dat, omega = 1, R = 399, seed = 1)
fit1$F_obs; fit1$crit_95; fit1$p_value
# Reject H0 at 5\% if F_obs > crit_95 (equivalently p_value < 0.05)

## Example 2: List-of-data.frames input (same data split by group)
lst <- split(dat[c("center","radius")], dat$group)
fit2 <- bootstrap_interval_levene(lst, omega = 0.5, R = 399, seed = 1)
fit2$p_value

## Example 3: Return bootstrap draws to visualize the null distribution
fit3 <- bootstrap_interval_levene(dat, omega = 1, R = 499, seed = 42, return_draws = TRUE)
hist(fit3$F_star, breaks = 30, main = "Bootstrap null of F", xlab = "F*")
abline(v = fit3$F_obs, lwd = 2)
}

}
\references{
Levene, H. (1960). Robust tests for equality of variances. In \emph{Contributions
to Probability and Statistics: Essays in Honor of Harold Hotelling}, 278–292.

Brown, M.B., & Forsythe, A.B. (1974). Robust tests for equality of variances.
\emph{Journal of the American Statistical Association}, 69(346), 364–367.
}
\seealso{
\itemize{
\item \code{car::leveneTest()} for classical Levene/Brown–Forsythe tests.
\item \code{stats::var.test()} for two-sample F test on variances (parametric).
}
}
